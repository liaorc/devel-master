--#
--#       Gpu Sort by Grouping TestCases. 
--#
set pg_strom.debug_force_gpusort to on;
set pg_strom.gpu_setup_cost=0;
set random_page_cost=1000000;   --# force off index_scan.   
set pg_strom.enable_gpusort to on;                                                                                                                                       
set client_min_messages to warning;
set enable_hashagg to off;      --# force off HashAggregate
--smallint
select row_number() over () as rowid, smlint_x from strom_test where id between     1 and 10000 group by smlint_x;
 rowid | smlint_x 
-------+----------
     1 |        0
     2 |        1
     3 |        2
     4 |        3
     5 |        4
     6 |        5
     7 |        6
     8 |        7
     9 |        8
    10 |        9
    11 |       10
    12 |       11
    13 |       12
    14 |       13
    15 |       14
    16 |       15
    17 |       16
    18 |       17
    19 |       18
    20 |       19
    21 |       20
    22 |       21
    23 |       22
    24 |       23
    25 |       24
    26 |       25
    27 |       26
    28 |       27
    29 |       28
    30 |       29
    31 |       30
    32 |       31
    33 |       32
    34 |       33
    35 |         
(35 rows)

select row_number() over () as rowid, smlint_x from strom_test where id between 10001 and 20000 group by smlint_x;
 rowid | smlint_x 
-------+----------
     1 |      -33
     2 |      -32
     3 |      -31
     4 |      -30
     5 |      -29
     6 |      -28
     7 |      -27
     8 |      -26
     9 |      -25
    10 |      -24
    11 |      -23
    12 |      -22
    13 |      -21
    14 |      -20
    15 |      -19
    16 |      -18
    17 |      -17
    18 |      -16
    19 |      -15
    20 |      -14
    21 |      -13
    22 |      -12
    23 |      -11
    24 |      -10
    25 |       -9
    26 |       -8
    27 |       -7
    28 |       -6
    29 |       -5
    30 |       -4
    31 |       -3
    32 |       -2
    33 |       -1
    34 |        0
    35 |         
(35 rows)

select row_number() over () as rowid, smlint_x from strom_test where id between 20001 and 30000 group by smlint_x;
 rowid | smlint_x 
-------+----------
     1 |      -33
     2 |      -32
     3 |      -31
     4 |      -30
     5 |      -29
     6 |      -28
     7 |      -27
     8 |      -26
     9 |      -25
    10 |      -24
    11 |      -23
    12 |      -22
    13 |      -21
    14 |      -20
    15 |      -19
    16 |      -18
    17 |      -17
    18 |      -16
    19 |      -15
    20 |      -14
    21 |      -13
    22 |      -12
    23 |      -11
    24 |      -10
    25 |       -9
    26 |       -8
    27 |       -7
    28 |       -6
    29 |       -5
    30 |       -4
    31 |       -3
    32 |       -2
    33 |       -1
    34 |        0
    35 |        1
    36 |        2
    37 |        3
    38 |        4
    39 |        5
    40 |        6
    41 |        7
    42 |        8
    43 |        9
    44 |       10
    45 |       11
    46 |       12
    47 |       13
    48 |       14
    49 |       15
    50 |       16
    51 |       17
    52 |       18
    53 |       19
    54 |       20
    55 |       21
    56 |       22
    57 |       23
    58 |       24
    59 |       25
    60 |       26
    61 |       27
    62 |       28
    63 |       29
    64 |       30
    65 |       31
    66 |       32
    67 |       33
    68 |         
(68 rows)

select row_number() over () as rowid, smlint_x from strom_test where id between 30001 and 40000 group by smlint_x;
 rowid | smlint_x 
-------+----------
     1 |         
(1 row)

--integer
select * from ( select row_number() over () as rowid, integer_x from strom_test where id between     1 and 10000 group by integer_x ) as t where t.rowid%100=0;
 rowid | integer_x 
-------+-----------
   100 |     24533
   200 |     48967
   300 |     71708
   400 |     98786
   500 |    122067
   600 |    146864
   700 |    169506
   800 |    193308
   900 |    212932
  1000 |    237015
  1100 |    258184
  1200 |    283878
  1300 |    307180
  1400 |    331182
  1500 |    352694
  1600 |    374951
  1700 |    398420
  1800 |    420409
  1900 |    440755
  2000 |    463301
  2100 |    487384
  2200 |    511417
  2300 |    536716
  2400 |    561737
  2500 |    583892
  2600 |    605652
  2700 |    628381
  2800 |    649502
  2900 |    669234
  3000 |    693990
  3100 |    716361
  3200 |    737895
  3300 |    759598
  3400 |    784139
  3500 |    804859
  3600 |    825386
  3700 |    849736
  3800 |    872374
  3900 |    897025
  4000 |    919598
  4100 |    940257
  4200 |    964385
  4300 |    987409
  4400 |   1008110
  4500 |   1033018
  4600 |   1056729
  4700 |   1085120
  4800 |   1105771
  4900 |   1127403
  5000 |   1149105
  5100 |   1169407
  5200 |   1187661
  5300 |   1213021
  5400 |   1234398
  5500 |   1259060
  5600 |   1277774
  5700 |   1301238
  5800 |   1324578
  5900 |   1347315
  6000 |   1367843
  6100 |   1387038
  6200 |   1414130
  6300 |   1435912
  6400 |   1457385
  6500 |   1478745
  6600 |   1503598
  6700 |   1522775
  6800 |   1543832
  6900 |   1564719
  7000 |   1589546
  7100 |   1609347
  7200 |   1633648
  7300 |   1654978
  7400 |   1677241
  7500 |   1697492
  7600 |   1720459
  7700 |   1747909
  7800 |   1770062
  7900 |   1791240
  8000 |   1815601
  8100 |   1839677
  8200 |   1864072
  8300 |   1886006
  8400 |   1903941
  8500 |   1923078
  8600 |   1947669
  8700 |   1971854
  8800 |   1996365
  8900 |   2015346
  9000 |   2040148
  9100 |   2059971
  9200 |   2080753
  9300 |   2105081
  9400 |   2126401
(94 rows)

select * from ( select row_number() over () as rowid, integer_x from strom_test where id between 10001 and 20000 group by integer_x ) as t where t.rowid%100=0;
 rowid | integer_x 
-------+-----------
   100 |  -2128184
   200 |  -2105918
   300 |  -2080873
   400 |  -2058119
   500 |  -2031277
   600 |  -2011506
   700 |  -1990874
   800 |  -1972939
   900 |  -1949642
  1000 |  -1928925
  1100 |  -1903664
  1200 |  -1879934
  1300 |  -1856633
  1400 |  -1832516
  1500 |  -1811888
  1600 |  -1788339
  1700 |  -1764257
  1800 |  -1744029
  1900 |  -1722178
  2000 |  -1700227
  2100 |  -1679346
  2200 |  -1654281
  2300 |  -1631747
  2400 |  -1611354
  2500 |  -1586197
  2600 |  -1563709
  2700 |  -1538790
  2800 |  -1514423
  2900 |  -1489860
  3000 |  -1467576
  3100 |  -1442641
  3200 |  -1422237
  3300 |  -1398912
  3400 |  -1375360
  3500 |  -1352453
  3600 |  -1331046
  3700 |  -1309840
  3800 |  -1288874
  3900 |  -1261277
  4000 |  -1235342
  4100 |  -1215699
  4200 |  -1191946
  4300 |  -1172386
  4400 |  -1150677
  4500 |  -1123380
  4600 |  -1099862
  4700 |  -1072385
  4800 |  -1055379
  4900 |  -1031095
  5000 |  -1010078
  5100 |   -987445
  5200 |   -967058
  5300 |   -945133
  5400 |   -924118
  5500 |   -901805
  5600 |   -880284
  5700 |   -858005
  5800 |   -830919
  5900 |   -805898
  6000 |   -780792
  6100 |   -759268
  6200 |   -737643
  6300 |   -713765
  6400 |   -694204
  6500 |   -672141
  6600 |   -646786
  6700 |   -623533
  6800 |   -600796
  6900 |   -581524
  7000 |   -558784
  7100 |   -537764
  7200 |   -515369
  7300 |   -491212
  7400 |   -468674
  7500 |   -449030
  7600 |   -425371
  7700 |   -404483
  7800 |   -383260
  7900 |   -356921
  8000 |   -335575
  8100 |   -310975
  8200 |   -290048
  8300 |   -268344
  8400 |   -244292
  8500 |   -222189
  8600 |   -200433
  8700 |   -179674
  8800 |   -158950
  8900 |   -130628
  9000 |   -105446
  9100 |    -82568
  9200 |    -58953
  9300 |    -36363
  9400 |    -14031
(94 rows)

select * from ( select row_number() over () as rowid, integer_x from strom_test where id between 20001 and 30000 group by integer_x ) as t where t.rowid%100=0;
 rowid | integer_x 
-------+-----------
   100 |  -2108471
   200 |  -2070413
   300 |  -2027755
   400 |  -1980240
   500 |  -1936129
   600 |  -1888388
   700 |  -1837993
   800 |  -1785871
   900 |  -1741394
  1000 |  -1697691
  1100 |  -1648962
  1200 |  -1606865
  1300 |  -1559719
  1400 |  -1517234
  1500 |  -1472827
  1600 |  -1426800
  1700 |  -1384809
  1800 |  -1343234
  1900 |  -1299106
  2000 |  -1249480
  2100 |  -1202481
  2200 |  -1158208
  2300 |  -1107580
  2400 |  -1060037
  2500 |  -1012058
  2600 |   -970910
  2700 |   -921933
  2800 |   -876561
  2900 |   -828838
  3000 |   -783509
  3100 |   -741708
  3200 |   -689695
  3300 |   -643367
  3400 |   -594975
  3500 |   -550589
  3600 |   -512896
  3700 |   -476112
  3800 |   -429285
  3900 |   -384437
  4000 |   -338705
  4100 |   -291353
  4200 |   -243947
  4300 |   -205136
  4400 |   -164751
  4500 |   -115500
  4600 |    -70498
  4700 |    -26245
  4800 |     23427
  4900 |     69444
  5000 |    114062
  5100 |    167229
  5200 |    212587
  5300 |    258312
  5400 |    300587
  5500 |    339510
  5600 |    376284
  5700 |    416068
  5800 |    464573
  5900 |    507337
  6000 |    557896
  6100 |    600791
  6200 |    639730
  6300 |    690962
  6400 |    727868
  6500 |    775801
  6600 |    821178
  6700 |    861401
  6800 |    907367
  6900 |    952043
  7000 |    998129
  7100 |   1044108
  7200 |   1084457
  7300 |   1127857
  7400 |   1178224
  7500 |   1227486
  7600 |   1278207
  7700 |   1323109
  7800 |   1368844
  7900 |   1406381
  8000 |   1457514
  8100 |   1500754
  8200 |   1551337
  8300 |   1600393
  8400 |   1646049
  8500 |   1698758
  8600 |   1738473
  8700 |   1781326
  8800 |   1826952
  8900 |   1876489
  9000 |   1923398
  9100 |   1972529
  9200 |   2011937
  9300 |   2058539
  9400 |   2093438
  9500 |   2143965
(95 rows)

select * from ( select row_number() over () as rowid, integer_x from strom_test where id between 30001 and 40000 group by integer_x ) as t;
 rowid | integer_x 
-------+-----------
     1 |          
(1 row)

--bigint
select * from ( select row_number() over () as rowid, bigint_x from strom_test where id between     1 and 10000 group by bigint_x ) as t where t.rowid%100=0;
 rowid |     bigint_x     
-------+------------------
   100 |   87981004899222
   200 |  194899452614410
   300 |  290331074720956
   400 |  389964076786123
   500 |  495811892233634
   600 |  584440290438283
   700 |  676514566674317
   800 |  777217943309124
   900 |  863876609382285
  1000 |  961600425469936
  1100 | 1075297615773434
  1200 | 1175896242450858
  1300 | 1260753242757792
  1400 | 1364869821312794
  1500 | 1462948294324912
  1600 | 1553103596352962
  1700 | 1640358777548964
  1800 | 1739407754256188
  1900 | 1826864846159741
  2000 | 1913781025587069
  2100 | 2015772046302118
  2200 | 2110130613779432
  2300 | 2196157095026360
  2400 | 2274592745563620
  2500 | 2379063409812439
  2600 | 2477753778225283
  2700 | 2575731959456072
  2800 | 2670759588348822
  2900 | 2768437366682026
  3000 | 2848860431731130
  3100 | 2950833344864060
  3200 | 3037336301192872
  3300 | 3139615952300146
  3400 | 3244821322244555
  3500 | 3352663291007598
  3600 | 3450243367424754
  3700 | 3546469661560275
  3800 | 3635279032506908
  3900 | 3745275425585103
  4000 | 3853544760773968
  4100 | 3940299281927242
  4200 | 4049439254231646
  4300 | 4151592770739372
  4400 | 4262387941835276
  4500 | 4362289422306116
  4600 | 4452589211328971
  4700 | 4554378171012612
  4800 | 4651962984778695
  4900 | 4727531220659864
  5000 | 4835695805891346
  5100 | 4926021716905296
  5200 | 5035226800913908
  5300 | 5134333119729500
  5400 | 5239296390957367
  5500 | 5328781446159008
  5600 | 5445014582722560
  5700 | 5543667198372872
  5800 | 5643217582447133
  5900 | 5748447940511269
  6000 | 5850396591373943
  6100 | 5934571744147800
  6200 | 6016672552271741
  6300 | 6109236411829846
  6400 | 6221010844059173
  6500 | 6313364078421082
  6600 | 6409595041186054
  6700 | 6511115118737097
  6800 | 6604865312686866
  6900 | 6697686153023193
  7000 | 6793871211177705
  7100 | 6890556830590697
  7200 | 6990928996527505
  7300 | 7094936981129396
  7400 | 7207327895784522
  7500 | 7307010358693069
  7600 | 7391278325710193
  7700 | 7482706845023338
  7800 | 7571963511044047
  7900 | 7681046811254981
  8000 | 7783096681611919
  8100 | 7878191002756841
  8200 | 7975529616112615
  8300 | 8063469161692529
  8400 | 8170521822840750
  8500 | 8263819825453728
  8600 | 8380087618108391
  8700 | 8465875836044575
  8800 | 8552198206178460
  8900 | 8653703255638934
  9000 | 8750191310851277
  9100 | 8831567347538985
  9200 | 8917967190292955
  9300 | 9018416034280898
  9400 | 9117495032809522
(94 rows)

select * from ( select row_number() over () as rowid, bigint_x from strom_test where id between 10001 and 20000 group by bigint_x ) as t where t.rowid%100=0;
 rowid |     bigint_x      
-------+-------------------
   100 | -9131794147169010
   200 | -9040010966636430
   300 | -8949708480374112
   400 | -8859708273910088
   500 | -8764051565452460
   600 | -8661925536735429
   700 | -8565858903714169
   800 | -8468047109516427
   900 | -8377977535035605
  1000 | -8277473397638693
  1100 | -8179439527861944
  1200 | -8067344768381747
  1300 | -7949507332684120
  1400 | -7852364896254558
  1500 | -7748072528983097
  1600 | -7668060904621081
  1700 | -7583323914290332
  1800 | -7479640418762621
  1900 | -7388761809882186
  2000 | -7289759429275156
  2100 | -7195236527759163
  2200 | -7081520353700217
  2300 | -6975933028019208
  2400 | -6863670219353620
  2500 | -6770735016923103
  2600 | -6685405742012301
  2700 | -6600036708589240
  2800 | -6499445920227131
  2900 | -6408940359321125
  3000 | -6302226850265432
  3100 | -6205182682687603
  3200 | -6113097931026334
  3300 | -6029167355165147
  3400 | -5937154432536936
  3500 | -5827209798109626
  3600 | -5739752792105419
  3700 | -5645088380006957
  3800 | -5549146842203161
  3900 | -5453912702692884
  4000 | -5355124198572294
  4100 | -5251686319339340
  4200 | -5159941720497979
  4300 | -5054416255230935
  4400 | -4957286407350518
  4500 | -4872154864144089
  4600 | -4756791604486865
  4700 | -4657869054436966
  4800 | -4555329879930831
  4900 | -4469623090279612
  5000 | -4356051690978280
  5100 | -4253269988258874
  5200 | -4163725490709856
  5300 | -4074444918901178
  5400 | -3967351326714626
  5500 | -3874651853564150
  5600 | -3789326976699859
  5700 | -3672314045874045
  5800 | -3566724972141347
  5900 | -3488241832150696
  6000 | -3379089898362372
  6100 | -3278861364721877
  6200 | -3190471431691436
  6300 | -3093728946911445
  6400 | -3012198789617287
  6500 | -2903525121912210
  6600 | -2810921825964392
  6700 | -2698850989452034
  6800 | -2590127293967892
  6900 | -2477776726235546
  7000 | -2386648725784101
  7100 | -2290893726999904
  7200 | -2191644909759365
  7300 | -2088169032950743
  7400 | -1980101758793286
  7500 | -1894626553778668
  7600 | -1813123596512395
  7700 | -1718150543769076
  7800 | -1628166155669602
  7900 | -1544099206006833
  8000 | -1455015837621551
  8100 | -1346494301953065
  8200 | -1258919777053704
  8300 | -1139078644623212
  8400 | -1033289240730927
  8500 |  -944161939125174
  8600 |  -849087851571184
  8700 |  -760016642238316
  8800 |  -674611226147291
  8900 |  -591192979754975
  9000 |  -484275622961480
  9100 |  -360387909783650
  9200 |  -276087073381810
  9300 |  -179996749320946
  9400 |   -74906639118893
(94 rows)

select * from ( select row_number() over () as rowid, bigint_x from strom_test where id between 20001 and 30000 group by bigint_x ) as t where t.rowid%100=0;
 rowid |     bigint_x      
-------+-------------------
   100 | -9047597004162596
   200 | -8865550674973164
   300 | -8671602149592924
   400 | -8490330898791662
   500 | -8300220476446212
   600 | -8091188524138627
   700 | -7899128684857000
   800 | -7692674657819820
   900 | -7509961010971673
  1000 | -7303673628665577
  1100 | -7101038643598328
  1200 | -6877564992606962
  1300 | -6700415149473268
  1400 | -6506187863535649
  1500 | -6317281646940783
  1600 | -6112505723755692
  1700 | -5925212851496026
  1800 | -5727038164195869
  1900 | -5535885782784410
  2000 | -5328979366841942
  2100 | -5120894549312406
  2200 | -4930716111864857
  2300 | -4754350022953271
  2400 | -4581838890528145
  2500 | -4375342712681922
  2600 | -4145441316714578
  2700 | -3958703474488640
  2800 | -3752781241712116
  2900 | -3568996283991458
  3000 | -3373591438280360
  3100 | -3198876721344414
  3200 | -2983150263642096
  3300 | -2790404071406698
  3400 | -2594680822590079
  3500 | -2405589200846979
  3600 | -2199490470684394
  3700 | -2008718331317584
  3800 | -1820930653055615
  3900 | -1622834915844292
  4000 | -1443709404934308
  4100 | -1237558413609664
  4200 | -1081030598249677
  4300 |  -903133679914582
  4400 |  -700914473451389
  4500 |  -520139231243272
  4600 |  -360475179224138
  4700 |  -171632064288784
  4800 |    53685545011773
  4900 |   247038702025441
  5000 |   457790745785401
  5100 |   647334722074050
  5200 |   802689057879490
  5300 |   988479980075745
  5400 |  1205561688938512
  5500 |  1381714945040712
  5600 |  1592178023400997
  5700 |  1772156454686425
  5800 |  1973459312697148
  5900 |  2159667473786339
  6000 |  2353201199815066
  6100 |  2529782724286218
  6200 |  2722911512208343
  6300 |  2899402679157522
  6400 |  3091990885315904
  6500 |  3277735945851372
  6600 |  3474082600581071
  6700 |  3670166592290816
  6800 |  3857660752487776
  6900 |  4053866025484026
  7000 |  4268869245053436
  7100 |  4467411383985636
  7200 |  4660762522364674
  7300 |  4860056675710665
  7400 |  5075605407666274
  7500 |  5262763847449575
  7600 |  5513352073657188
  7700 |  5724393306155123
  7800 |  5942139231710216
  7900 |  6106128874142171
  8000 |  6295958912432603
  8100 |  6502081634282504
  8200 |  6690454175421039
  8300 |  6882696860050391
  8400 |  7061180900414849
  8500 |  7288679245000212
  8600 |  7469781102291321
  8700 |  7655649101970670
  8800 |  7842688949116994
  8900 |  8002834870696935
  9000 |  8181616517935268
  9100 |  8380416286185751
  9200 |  8593553333875114
  9300 |  8791307801575031
  9400 |  8991559801347506
  9500 |  9177481531067728
(95 rows)

select * from ( select row_number() over () as rowid, bigint_x from strom_test where id between 30001 and 40000 group by bigint_x ) as t;
 rowid | bigint_x 
-------+----------
     1 |         
(1 row)

--real
select * from ( select row_number() over () as rowid, real_x from strom_test where id between     1 and 10000 group by real_x ) as t where t.rowid%100=0;
 rowid | real_x 
-------+--------
   100 |  0.018
   200 | 0.0336
   300 | 0.0492
   400 | 0.0643
   500 | 0.0791
   600 |  0.094
   700 | 0.1101
   800 | 0.1269
   900 | 0.1446
  1000 |  0.163
  1100 | 0.1804
  1200 | 0.1964
  1300 | 0.2136
  1400 | 0.2306
  1500 | 0.2463
  1600 | 0.2626
  1700 | 0.2784
  1800 | 0.2953
  1900 | 0.3114
  2000 | 0.3276
  2100 | 0.3439
  2200 |   0.36
  2300 | 0.3769
  2400 | 0.3936
  2500 | 0.4096
  2600 | 0.4255
  2700 | 0.4412
  2800 | 0.4586
  2900 |  0.474
  3000 | 0.4911
  3100 |  0.508
  3200 | 0.5246
  3300 | 0.5406
  3400 |  0.556
  3500 | 0.5704
  3600 | 0.5854
  3700 | 0.6006
  3800 | 0.6186
  3900 | 0.6335
  4000 | 0.6488
  4100 | 0.6649
  4200 |   0.68
  4300 | 0.6958
  4400 | 0.7115
  4500 | 0.7279
  4600 |  0.744
  4700 | 0.7618
  4800 | 0.7786
  4900 | 0.7963
  5000 | 0.8131
  5100 | 0.8289
  5200 |  0.846
  5300 | 0.8628
  5400 | 0.8795
  5500 | 0.8966
  5600 | 0.9125
  5700 | 0.9284
  5800 | 0.9448
  5900 | 0.9613
  6000 | 0.9787
  6100 | 0.9961
(61 rows)

select * from ( select row_number() over () as rowid, real_x from strom_test where id between 10001 and 20000 group by real_x ) as t where t.rowid%100=0;
 rowid | real_x  
-------+---------
   100 | -0.9838
   200 | -0.9661
   300 | -0.9487
   400 | -0.9337
   500 | -0.9175
   600 | -0.9029
   700 | -0.8864
   800 | -0.8701
   900 | -0.8545
  1000 | -0.8381
  1100 | -0.8228
  1200 |  -0.806
  1300 | -0.7912
  1400 | -0.7743
  1500 | -0.7596
  1600 | -0.7424
  1700 | -0.7282
  1800 | -0.7141
  1900 | -0.6981
  2000 | -0.6823
  2100 | -0.6666
  2200 | -0.6509
  2300 | -0.6318
  2400 | -0.6161
  2500 | -0.6004
  2600 |  -0.581
  2700 |  -0.565
  2800 | -0.5467
  2900 | -0.5301
  3000 | -0.5118
  3100 | -0.4961
  3200 | -0.4797
  3300 | -0.4627
  3400 | -0.4464
  3500 | -0.4291
  3600 |  -0.414
  3700 | -0.3987
  3800 | -0.3831
  3900 | -0.3677
  4000 | -0.3511
  4100 | -0.3339
  4200 | -0.3171
  4300 |    -0.3
  4400 | -0.2831
  4500 | -0.2662
  4600 | -0.2497
  4700 | -0.2328
  4800 | -0.2155
  4900 | -0.2003
  5000 | -0.1834
  5100 | -0.1676
  5200 | -0.1533
  5300 | -0.1364
  5400 | -0.1197
  5500 | -0.1041
  5600 | -0.0871
  5700 | -0.0724
  5800 | -0.0555
  5900 | -0.0363
  6000 | -0.0192
  6100 | -0.0037
(61 rows)

select * from ( select row_number() over () as rowid, real_x from strom_test where id between 20001 and 30000 group by real_x ) as t where t.rowid%100=0;
 rowid | real_x  
-------+---------
   100 | -0.9754
   200 | -0.9478
   300 | -0.9175
   400 | -0.8904
   500 | -0.8629
   600 | -0.8346
   700 | -0.8118
   800 | -0.7862
   900 | -0.7606
  1000 | -0.7368
  1100 | -0.7096
  1200 | -0.6826
  1300 | -0.6534
  1400 | -0.6271
  1500 | -0.6017
  1600 | -0.5765
  1700 | -0.5489
  1800 | -0.5195
  1900 | -0.4941
  2000 | -0.4678
  2100 | -0.4411
  2200 | -0.4132
  2300 | -0.3869
  2400 | -0.3607
  2500 | -0.3363
  2600 | -0.3102
  2700 |  -0.283
  2800 | -0.2591
  2900 | -0.2331
  3000 | -0.2054
  3100 | -0.1789
  3200 | -0.1535
  3300 |  -0.128
  3400 |  -0.105
  3500 | -0.0789
  3600 | -0.0532
  3700 | -0.0251
  3800 |  0.0041
  3900 |  0.0305
  4000 |  0.0543
  4100 |  0.0785
  4200 |  0.1013
  4300 |   0.126
  4400 |  0.1547
  4500 |   0.181
  4600 |  0.2065
  4700 |  0.2365
  4800 |  0.2613
  4900 |    0.29
  5000 |  0.3192
  5100 |  0.3422
  5200 |  0.3696
  5300 |  0.3951
  5400 |  0.4203
  5500 |  0.4445
  5600 |  0.4738
  5700 |  0.5017
  5800 |  0.5279
  5900 |  0.5529
  6000 |  0.5797
  6100 |  0.6077
  6200 |  0.6311
  6300 |   0.657
  6400 |   0.684
  6500 |  0.7147
  6600 |   0.742
  6700 |  0.7662
  6800 |  0.7944
  6900 |  0.8217
  7000 |  0.8495
  7100 |  0.8743
  7200 |  0.8998
  7300 |  0.9245
  7400 |  0.9529
  7500 |  0.9774
(75 rows)

select * from ( select row_number() over () as rowid, real_x from strom_test where id between 30001 and 40000 group by real_x ) as t;
 rowid | real_x 
-------+--------
     1 |       
(1 row)

--float
select * from ( select row_number() over () as rowid, float_x from strom_test where id between     1 and 10000 group by float_x ) as t where t.rowid%100=0;
 rowid |     float_x     
-------+-----------------
   100 | 0.0101803671569
   200 | 0.0206963578239
   300 | 0.0330182509497
   400 | 0.0441052732058
   500 | 0.0535471113399
   600 | 0.0638180212118
   700 | 0.0739246634766
   800 | 0.0839117835276
   900 | 0.0935561694205
  1000 | 0.1040899110958
  1100 | 0.1137752714567
  1200 | 0.1240672999993
  1300 |  0.133775618393
  1400 |  0.143401551526
  1500 | 0.1536470581777
  1600 | 0.1650151773356
  1700 | 0.1756562585942
  1800 | 0.1862004003488
  1900 | 0.1964088054374
  2000 | 0.2084929337725
  2100 | 0.2174772294238
  2200 | 0.2276597777382
  2300 | 0.2363305767067
  2400 | 0.2460712054744
  2500 | 0.2565885791555
  2600 | 0.2687361957505
  2700 | 0.2783385235816
  2800 | 0.2877710079774
  2900 |  0.299181020353
  3000 | 0.3105730316602
  3100 | 0.3222755859606
  3200 |  0.331255890429
  3300 | 0.3408779157326
  3400 | 0.3518794551492
  3500 | 0.3620259664021
  3600 | 0.3730944315903
  3700 | 0.3856957103126
  3800 | 0.3965708296746
  3900 |  0.405489649158
  4000 | 0.4145092964172
  4100 | 0.4249335364439
  4200 | 0.4351251032203
  4300 | 0.4450096935034
  4400 | 0.4575248048641
  4500 | 0.4695576773956
  4600 | 0.4811868490651
  4700 | 0.4922526101582
  4800 | 0.5040763076395
  4900 | 0.5153169995174
  5000 | 0.5266925939359
  5100 | 0.5383040574379
  5200 |  0.547946237959
  5300 |  0.559682559222
  5400 | 0.5706485067494
  5500 | 0.5794773553498
  5600 | 0.5901782456785
  5700 | 0.5995726794936
  5800 | 0.6097146393731
  5900 | 0.6203417656943
  6000 | 0.6289276690222
  6100 | 0.6406689239666
  6200 | 0.6520557799377
  6300 |  0.662192040123
  6400 | 0.6729795886204
  6500 | 0.6842506197281
  6600 |  0.692323113326
  6700 | 0.7039679707959
  6800 | 0.7159595144913
  6900 | 0.7258596969768
  7000 | 0.7362595382147
  7100 |  0.745909054298
  7200 |  0.756543497555
  7300 | 0.7688335790299
  7400 | 0.7780920290388
  7500 | 0.7900415537879
  7600 | 0.7992065101862
  7700 | 0.8112205853686
  7800 | 0.8211515238509
  7900 | 0.8308403701521
  8000 | 0.8406651820987
  8100 | 0.8524933191948
  8200 | 0.8632043944672
  8300 | 0.8728875527158
  8400 | 0.8821482304484
  8500 | 0.8930906336755
  8600 | 0.9053080310114
  8700 |  0.915243496187
  8800 | 0.9267065594904
  8900 |  0.936744984705
  9000 | 0.9481558552943
  9100 | 0.9589568870142
  9200 | 0.9699664725922
  9300 | 0.9803937254474
  9400 | 0.9894120194949
  9500 | 0.9987145992927
(95 rows)

select * from ( select row_number() over () as rowid, float_x from strom_test where id between 10001 and 20000 group by float_x ) as t where t.rowid%100=0;
 rowid |     float_x      
-------+------------------
   100 | -0.9880630434491
   200 | -0.9789324807934
   300 |  -0.969026544597
   400 | -0.9586786287837
   500 | -0.9488340988755
   600 |  -0.938543479424
   700 | -0.9283244004473
   800 | -0.9176236288622
   900 | -0.9077113745734
  1000 | -0.8959875097498
  1100 | -0.8852761383168
  1200 | -0.8738031997345
  1300 | -0.8632361884229
  1400 | -0.8521947185509
  1500 | -0.8394218608737
  1600 |  -0.828289071098
  1700 |  -0.817783231847
  1800 | -0.8087715646252
  1900 | -0.7979930285364
  2000 | -0.7890867833048
  2100 | -0.7780980244279
  2200 | -0.7677917899564
  2300 | -0.7571940105408
  2400 | -0.7473367527127
  2500 | -0.7366834981367
  2600 | -0.7272843159735
  2700 | -0.7172686788253
  2800 | -0.7055261270143
  2900 | -0.6967910239473
  3000 | -0.6872865371406
  3100 | -0.6781358849257
  3200 |  -0.667198095005
  3300 | -0.6569127207622
  3400 | -0.6459472859278
  3500 | -0.6369182518683
  3600 |  -0.627652451396
  3700 | -0.6183113725856
  3800 | -0.6081137075089
  3900 |  -0.596888715867
  4000 | -0.5859081516974
  4100 | -0.5739867761731
  4200 | -0.5643752925098
  4300 | -0.5542962625623
  4400 | -0.5437571853399
  4500 | -0.5335140936077
  4600 | -0.5238834964111
  4700 | -0.5137933758087
  4800 |   -0.50155039737
  4900 | -0.4894939782098
  5000 | -0.4790461650118
  5100 | -0.4678499377333
  5200 | -0.4554326110519
  5300 | -0.4438895620406
  5400 | -0.4330711793154
  5500 |  -0.422471084632
  5600 | -0.4104576520622
  5700 | -0.4006624049507
  5800 | -0.3897289196029
  5900 | -0.3802005052567
  6000 | -0.3694010148756
  6100 | -0.3582672723569
  6200 |  -0.348811947275
  6300 |  -0.337137717288
  6400 | -0.3276080945507
  6500 |  -0.316214742139
  6600 | -0.3050362337381
  6700 | -0.2937222002074
  6800 | -0.2834448372014
  6900 | -0.2718148194253
  7000 | -0.2605017554015
  7100 |  -0.250470070634
  7200 | -0.2401131214574
  7300 | -0.2296292227693
  7400 | -0.2195175373927
  7500 | -0.2093654549681
  7600 | -0.1978232273832
  7700 | -0.1864704759791
  7800 | -0.1761180944741
  7900 |   -0.16668782942
  8000 | -0.1568937595002
  8100 | -0.1473274026066
  8200 | -0.1369135826826
  8300 | -0.1254067500122
  8400 | -0.1143847703934
  8500 | -0.1033297656104
  8600 | -0.0942748403177
  8700 | -0.0832015904598
  8800 | -0.0727375117131
  8900 | -0.0632507731207
  9000 | -0.0522781433538
  9100 | -0.0416402081028
  9200 | -0.0336918164976
  9300 | -0.0221744840965
  9400 | -0.0113156805746
  9500 |                 
(95 rows)

select * from ( select row_number() over () as rowid, float_x from strom_test where id between 20001 and 30000 group by float_x ) as t where t.rowid%100=0;
 rowid |     float_x      
-------+------------------
   100 | -0.9781036674976
   200 | -0.9539097426459
   300 | -0.9356675613672
   400 | -0.9173701088876
   500 | -0.8981478540227
   600 |  -0.878919375129
   700 | -0.8598141642287
   800 | -0.8421619078144
   900 | -0.8209089264274
  1000 | -0.8001357298344
  1100 | -0.7796656098217
  1200 | -0.7566950768232
  1300 | -0.7363751400262
  1400 | -0.7183517217636
  1500 | -0.6956548765302
  1600 | -0.6732519567013
  1700 | -0.6498002866283
  1800 | -0.6293153744191
  1900 |  -0.607607443817
  2000 | -0.5870389994234
  2100 | -0.5675298059359
  2200 | -0.5418448057026
  2300 | -0.5180584629998
  2400 | -0.4982833135873
  2500 | -0.4756606630981
  2600 | -0.4552163165063
  2700 |  -0.433650678955
  2800 | -0.4141137292609
  2900 | -0.3885006662458
  3000 |  -0.369545083493
  3100 | -0.3493109289557
  3200 | -0.3285848293453
  3300 | -0.3077059332281
  3400 | -0.2872673533857
  3500 | -0.2631886946037
  3600 | -0.2437940882519
  3700 | -0.2224490987137
  3800 | -0.1980505408719
  3900 |  -0.174370794557
  4000 | -0.1520247617736
  4100 | -0.1303900294006
  4200 | -0.1099655423313
  4300 |  -0.084595146589
  4400 |  -0.063227201812
  4500 | -0.0412716511637
  4600 | -0.0191397285089
  4700 |  0.0028950832784
  4800 |   0.028035252355
  4900 |  0.0476363468915
  5000 |  0.0664239702746
  5100 |  0.0883347932249
  5200 |  0.1083676079288
  5300 |  0.1286190096289
  5400 |  0.1494670873508
  5500 |   0.171257995069
  5600 |  0.1938012922183
  5700 |  0.2137707984075
  5800 |   0.239650119096
  5900 |  0.2582433801144
  6000 |   0.281965653412
  6100 |  0.3007121924311
  6200 |  0.3252521110699
  6300 |  0.3475765390322
  6400 |  0.3716443125159
  6500 |  0.3919077506289
  6600 |  0.4123648982495
  6700 |  0.4309170087799
  6800 |  0.4503477467224
  6900 |  0.4726504664868
  7000 |  0.4925632597879
  7100 |  0.5138179985806
  7200 |  0.5341880880296
  7300 |  0.5567551562563
  7400 |  0.5719316629693
  7500 |  0.5935385255143
  7600 |  0.6126429196447
  7700 |  0.6313815182075
  7800 |  0.6491171848029
  7900 |  0.6712077101693
  8000 |  0.6907451990992
  8100 |  0.7083451235667
  8200 |  0.7266592010856
  8300 |   0.747770961374
  8400 |   0.768840146251
  8500 |  0.7882676189765
  8600 |  0.8111685914919
  8700 |  0.8354143630713
  8800 |  0.8542334046215
  8900 |  0.8779498217627
  9000 |  0.9005656959489
  9100 |  0.9196830000728
  9200 |  0.9412376042455
  9300 |  0.9609220148996
  9400 |  0.9823336992413
  9500 |  0.9995279451832
(95 rows)

select * from ( select row_number() over () as rowid, float_x from strom_test where id between 30001 and 40000 group by float_x ) as t;
 rowid | float_x 
-------+---------
     1 |        
(1 row)

--numeric
select * from ( select row_number() over () as rowid, nume_x from strom_test where id between     1 and 10000 group by nume_x ) as t where t.rowid%100=0;
 rowid |       nume_x       
-------+--------------------
   100 | 0.0109342727810144
   200 | 0.0231047659181058
   300 | 0.0330680711194873
   400 | 0.0431863651610911
   500 | 0.0545041742734611
   600 |  0.064822874031961
   700 | 0.0750526152551174
   800 |   0.08554035006091
   900 |  0.096142690628767
  1000 |  0.105220987461507
  1100 |  0.115396684966981
  1200 |  0.126374405808747
  1300 |  0.137102907057852
  1400 |  0.147758686449379
  1500 |   0.15679527958855
  1600 |  0.168036135844886
  1700 |  0.179123119451106
  1800 |  0.188961233943701
  1900 |  0.198323849588633
  2000 |  0.207979670725763
  2100 |  0.218548075761646
  2200 |  0.229772299062461
  2300 |  0.240820547100157
  2400 |  0.253384493757039
  2500 |  0.265436116605997
  2600 |  0.276716751046479
  2700 |  0.286523092072457
  2800 |  0.294902398250997
  2900 |   0.30292801046744
  3000 |  0.312998778186738
  3100 |  0.322497260291129
  3200 |  0.333411224652082
  3300 |  0.343959444668144
  3400 |  0.353680061642081
  3500 |  0.363444114103913
  3600 |  0.373574304860085
  3700 |  0.384116811677814
  3800 |  0.395941290073097
  3900 |  0.404339516535401
  4000 |  0.413985708728433
  4100 |  0.425343131646514
  4200 |    0.4351477031596
  4300 |  0.444532911293209
  4400 |  0.455144508276135
  4500 |  0.466556929051876
  4600 |  0.478352791629732
  4700 |  0.488006202038378
  4800 |  0.501514218747616
  4900 |   0.51308511197567
  5000 |  0.522132913116366
  5100 |  0.532613924704492
  5200 |  0.545355200767517
  5300 |  0.555423930287361
  5400 |  0.565405175555497
  5500 |  0.576200619805604
  5600 |  0.586068851407617
  5700 |  0.595679305493832
  5800 |  0.605359285138547
  5900 |  0.615675116423517
  6000 |  0.626196458470076
  6100 |  0.637398016173393
  6200 |  0.647668443620205
  6300 |  0.658653209917247
  6400 |  0.669460000935942
  6500 |  0.679686692543328
  6600 |  0.690907823853195
  6700 |  0.700910348445177
  6800 |  0.712720235344023
  6900 |  0.720739849843085
  7000 |  0.729615712538362
  7100 |  0.740270921960473
  7200 |  0.752081416081637
  7300 |  0.763252360280603
  7400 |  0.773942627478391
  7500 |  0.782963052392006
  7600 |  0.792385255452245
  7700 |  0.803798704408109
  7800 |  0.815196829847991
  7900 |  0.826953796669841
  8000 |  0.837006401736289
  8100 |  0.849939370527864
  8200 |  0.859428419265896
  8300 |  0.872005305718631
  8400 |   0.88393697142601
  8500 |  0.895289598964155
  8600 |  0.904935853555799
  8700 |  0.916322301141918
  8800 |  0.926293805707246
  8900 |  0.937022999394685
  9000 |   0.94706692872569
  9100 |  0.958775003440678
  9200 |  0.969587689265609
  9300 |   0.97930249851197
  9400 |  0.988974511157721
  9500 |   0.99923330033198
(95 rows)

select * from ( select row_number() over () as rowid, nume_x from strom_test where id between 10001 and 20000 group by nume_x ) as t where t.rowid%100=0;
 rowid |        nume_x        
-------+----------------------
   100 |   -0.989558961242437
   200 |   -0.978736353572458
   300 |   -0.968043494503945
   400 |   -0.957090870011598
   500 |   -0.945668022148311
   600 |   -0.935803665779531
   700 |   -0.925439410842955
   800 |   -0.913452859502286
   900 |   -0.903577230870724
  1000 |   -0.893331774044782
  1100 |   -0.882441689725965
  1200 |   -0.872210911009461
  1300 |   -0.860911142546684
  1400 |   -0.851672079879791
  1500 |   -0.839863615576178
  1600 |   -0.829944413620979
  1700 |   -0.819097045343369
  1800 |    -0.80796736292541
  1900 |   -0.796633529942483
  2000 |   -0.785501023288816
  2100 |   -0.775857334025204
  2200 |   -0.765485205687582
  2300 |   -0.755348954349756
  2400 |   -0.745767118874937
  2500 |   -0.734800265636295
  2600 |   -0.725347824860364
  2700 |   -0.715148242656142
  2800 |   -0.703649559058249
  2900 |   -0.692299260292202
  3000 |   -0.682929904665798
  3100 |   -0.671748839784414
  3200 |   -0.662084503099322
  3300 |   -0.651753172744066
  3400 |   -0.639766715466976
  3500 |   -0.629411372356117
  3600 |   -0.619355504866689
  3700 |   -0.609781281091273
  3800 |   -0.597874235361814
  3900 |   -0.586787433363497
  4000 |   -0.577445950359106
  4100 |   -0.566256812773645
  4200 |   -0.556299129966646
  4300 |   -0.543987225275487
  4400 |   -0.533634604886174
  4500 |   -0.523048858623952
  4600 |   -0.512487792875618
  4700 |   -0.501718085259199
  4800 |   -0.491563641931862
  4900 |   -0.481939480639994
  5000 |   -0.469933776184916
  5100 |   -0.458581045269966
  5200 |   -0.448164644651115
  5300 |   -0.437701337970793
  5400 |   -0.426807831972837
  5500 |   -0.416721573099494
  5600 |   -0.408810821827501
  5700 |   -0.397987673524767
  5800 |   -0.386663376353681
  5900 |   -0.375627750530839
  6000 |   -0.366612220183015
  6100 |   -0.357752577867359
  6200 |      -0.348543189466
  6300 |   -0.337316526100039
  6400 |   -0.326599392574281
  6500 |   -0.318159116897732
  6600 |    -0.30760082649067
  6700 |   -0.295531080104411
  6800 |   -0.283613110892475
  6900 |   -0.273357016500086
  7000 |   -0.262127089314163
  7100 |   -0.251147504430264
  7200 |   -0.239050837233663
  7300 |    -0.22842698963359
  7400 |   -0.217631295789033
  7500 |   -0.206694110762328
  7600 |   -0.196129634976387
  7700 |   -0.186048003844917
  7800 |   -0.178214391227812
  7900 |   -0.167966840788722
  8000 |   -0.157831937074661
  8100 |   -0.148250314407051
  8200 |   -0.139002690091729
  8300 |   -0.128350302577019
  8400 |   -0.118907149415463
  8500 |   -0.109207846224308
  8600 |  -0.0988745372742414
  8700 |  -0.0892072473652661
  8800 |  -0.0791009576059878
  8900 |  -0.0672286017797887
  9000 |  -0.0574621357955039
  9100 |  -0.0457006371580064
  9200 |  -0.0357204722240567
  9300 |  -0.0247881226241589
  9400 |  -0.0131491064094007
  9500 | -0.00121313286945224
(95 rows)

select * from ( select row_number() over () as rowid, nume_x from strom_test where id between 20001 and 30000 group by nume_x ) as t where t.rowid%100=0;
 rowid |       nume_x        
-------+---------------------
   100 |  -0.979345054365695
   200 |   -0.95703009609133
   300 |  -0.937585934065282
   400 |  -0.920209883712232
   500 |  -0.901529668830335
   600 |  -0.880949801765382
   700 |  -0.857701835222542
   800 |  -0.837716466747224
   900 |  -0.819395798258483
  1000 |  -0.799298392608762
  1100 |  -0.780531451106071
  1200 |  -0.758599658496678
  1300 |  -0.739171460270882
  1400 |  -0.718268886208534
  1500 |  -0.696457649581134
  1600 |  -0.679578308016062
  1700 |  -0.657265920192003
  1800 |  -0.637149568647146
  1900 |  -0.616114639677107
  2000 |  -0.594680647365749
  2100 |  -0.572811914607882
  2200 |  -0.552129373885691
  2300 |  -0.533122994937003
  2400 |  -0.508986179716885
  2500 |  -0.485512725077569
  2600 |  -0.465355535969138
  2700 |  -0.444693225435913
  2800 |  -0.426979708485305
  2900 |   -0.40509897377342
  3000 |  -0.384301328100264
  3100 |   -0.36608967743814
  3200 |  -0.345874128863215
  3300 |  -0.325486456975341
  3400 |  -0.304807344451547
  3500 |  -0.280307061970234
  3600 |  -0.259829656220973
  3700 |  -0.235976299270988
  3800 |   -0.21427445858717
  3900 |  -0.192464593797922
  4000 |  -0.172079061158001
  4100 |  -0.146427637897432
  4200 |  -0.126027216203511
  4300 |  -0.103502508252859
  4400 | -0.0834936937317252
  4500 | -0.0631782440468669
  4600 | -0.0415422581136227
  4700 | -0.0186596075072885
  4800 | 0.00163074396550655
  4900 |  0.0207216180860996
  5000 |  0.0407919799908996
  5100 |  0.0642645861953497
  5200 |  0.0930087622255087
  5300 |   0.115516390651464
  5400 |    0.13725161831826
  5500 |   0.161137809976935
  5600 |   0.182150000706315
  5700 |   0.203274497762322
  5800 |   0.225467277690768
  5900 |   0.244967656210065
  6000 |   0.262404818087816
  6100 |   0.283239373005927
  6200 |   0.303425439633429
  6300 |   0.321345900185406
  6400 |   0.342195587232709
  6500 |   0.361372054554522
  6600 |   0.385570995509624
  6700 |   0.408228005282581
  6800 |   0.433788781985641
  6900 |   0.456671984866261
  7000 |   0.479857482016087
  7100 |   0.499787486158311
  7200 |   0.520917566493154
  7300 |   0.542889191769063
  7400 |   0.561888921074569
  7500 |   0.583338144235313
  7600 |   0.602923450060189
  7700 |   0.625237478874624
  7800 |   0.646473367698491
  7900 |   0.666160529479384
  8000 |   0.683379230089486
  8100 |   0.704271155409515
  8200 |    0.72793787624687
  8300 |   0.748905334621668
  8400 |   0.771648108027875
  8500 |   0.789971486665308
  8600 |   0.810280391015112
  8700 |   0.834975887089968
  8800 |   0.855981891043484
  8900 |   0.876023655757308
  9000 |   0.894455855712295
  9100 |   0.914567588828504
  9200 |    0.93599558994174
  9300 |   0.956268778070807
  9400 |   0.978778600692749
(94 rows)

select * from ( select row_number() over () as rowid, nume_x from strom_test where id between 30001 and 40000 group by nume_x ) as t;
 rowid | nume_x 
-------+--------
     1 |       
(1 row)

